{% extends "layout.html" %}

{% block main %}

{% if session["user_id"] %}
<div class="container text-center dashboard">
  <div class="row">
    <div class="col">      
      <table class="table table-responsive-sm table-sm">
        <thead class="table-primary">
          <tr class="table-primary">
            <th class="table-primary" colspan="2">Account Overview</th>
          </tr>
        </thead>          
        <thead class="table-light">
          <tr class="table-secondary">
            <th class="table-secondary">username</th>
            <th class="table-secondary">point balance</th>
          </tr>
        </thead>        
        <tbody>
          {% for user in user %}
          <tr class="table-light">
            <td class="table-light">{{ user[1] }}</td>
            <td class="table-light">{{ user[3] }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="col">
      <table class="table table-responsive-sm table-sm">
        <thead class="table-primary">
          <tr class="table-primary">
            <th class="table-primary" colspan="5">Account History</th>
          </tr>
        </thead>        
        <thead class="table-secondary">
          <tr class="table-secondary">
            <th class="table-secondary">bubble #</th>
            <th class="table-secondary">points invested</th>
            <th class="table-secondary">points earned</th>
            <th class="table-secondary">created on</th>
            <th class="table-secondary">archived on</th>
          </tr>
        </thead>
        <tbody>
          {% for user in user_history %}
          <tr class="table-light">
            <td class="table-light">{{ user[3] }}</td>
            <td class="table-light">{{ user[6] }}</td>
            <td class="table-light">{{ user[7] }}</td>
            <td class="table-light">{{ user[8] }}</td>
            <td class="table-light">{{ user[9] }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>


<form action="/" method="post" class="d-flex align-items-center justify-content-center">
  <input class="form-control me-2 w-auto" name="points" placeholder="Enter points" type="number">
  <button class="btn btn-primary" type="submit">Create Bubble</button>
</form>


{% endif %}

<figure class="text-center">
  <blockquote class="blockquote">
    <p>Accumulated Points: {{ current_points_in[0] }}</p>
    <p>Points Needed to Pop Next Bubble: {{ points_in_required }}</p>
  </blockquote>
</figure>


<table class="table table-success table-sm text-center">
  <thead class="table-primary">
    <tr class="table-primary">
      <th class="table-primary" colspan="5"><span class="blue">dub</span><span class="red">l</span><span class="yellow">bub</span><span class="green">l</span></th>
    </tr>
  </thead>          
  <thead>
    <tr class="table-secondary">
      <th>bubble #</th>
      <th>username</th>
      <th>points invested</th>
      <th>points to be earned</th>
      <th>created on</th>
    </tr>
  </thead>
  <tbody>
    {% for row in dublbubl %}
    <tr class="
    {% if row[3] == 10000 %}
      table-dark
    {% elif row[3] > 5000 %}
      table-danger
    {% elif row[3] > 1000 %}
      table-warning
    {% else %}
      table-success
    {% endif %}
    ">
      <td>{{ row[0] }}</td>
      <td>{{ row[2] }}</td>
      <td>{{ row[3] }}</td>
      <td>{{ row[4] }}</td>
      <td>{{ row[5] }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<!-- Pagination controls -->
<div class="pagination d-flex justify-content-center align-items-center">
  {% if page > 1 %}
    <a href="{{ url_for('index', page=page-1) }}" class="btn btn-primaryr">Previous</a>
  {% endif %}

  {% for p in range(1, total_pages + 1) %}
    <a href="{{ url_for('index', page=p) }}" class="btn btn-secondary {% if p == page %}active{% endif %}">
      {{ p }}
    </a>
  {% endfor %}

  {% if page < total_pages %}
    <a href="{{ url_for('index', page=page+1) }}" class="btn btn-primary">Next</a>
  {% endif %}
</div>

{% endblock %}